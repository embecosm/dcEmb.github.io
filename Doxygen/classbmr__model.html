<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DCM: bmr_model&lt; dynamic_model_template &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DCM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classbmr__model-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">bmr_model&lt; dynamic_model_template &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="bmr__model_8hh_source.html">bmr_model.hh</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ab636c57d4299fd8e4bbe2c48b3b70a6c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbmr__model.html#ab636c57d4299fd8e4bbe2c48b3b70a6c">reduce</a> ()</td></tr>
<tr class="separator:ab636c57d4299fd8e4bbe2c48b3b70a6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a06c8518ed8329cf6a8bf935f61d94dad"><td class="memItemLeft" align="right" valign="top"><a id="a06c8518ed8329cf6a8bf935f61d94dad"></a>
dynamic_model_template&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbmr__model.html#a06c8518ed8329cf6a8bf935f61d94dad">DCM_in</a></td></tr>
<tr class="memdesc:a06c8518ed8329cf6a8bf935f61d94dad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Input DCM model. <br /></td></tr>
<tr class="separator:a06c8518ed8329cf6a8bf935f61d94dad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac210d93768fb513f33939255eb8cb42"><td class="memItemLeft" align="right" valign="top"><a id="aac210d93768fb513f33939255eb8cb42"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbmr__model.html#aac210d93768fb513f33939255eb8cb42">beta</a> = 0</td></tr>
<tr class="memdesc:aac210d93768fb513f33939255eb8cb42"><td class="mdescLeft">&#160;</td><td class="mdescRight">beta parameter, prior expectation of reduced parameters. Currently unused. <br /></td></tr>
<tr class="separator:aac210d93768fb513f33939255eb8cb42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0879505c20dc53dbc926103a696bba2b"><td class="memItemLeft" align="right" valign="top"><a id="a0879505c20dc53dbc926103a696bba2b"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbmr__model.html#a0879505c20dc53dbc926103a696bba2b">gamma</a> = 0</td></tr>
<tr class="memdesc:a0879505c20dc53dbc926103a696bba2b"><td class="mdescLeft">&#160;</td><td class="mdescRight">gamma parameter, prior variance of reduced parameters. Currently unused. <br /></td></tr>
<tr class="separator:a0879505c20dc53dbc926103a696bba2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac94fce827a7708122e50b283f76d0a28"><td class="memItemLeft" align="right" valign="top"><a id="ac94fce827a7708122e50b283f76d0a28"></a>
Eigen::VectorXd&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbmr__model.html#ac94fce827a7708122e50b283f76d0a28">free_energy_vector</a></td></tr>
<tr class="memdesc:ac94fce827a7708122e50b283f76d0a28"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector of free energies for reduced models. <br /></td></tr>
<tr class="separator:ac94fce827a7708122e50b283f76d0a28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25229cd8668a635081cef6c04ccfd37e"><td class="memItemLeft" align="right" valign="top"><a id="a25229cd8668a635081cef6c04ccfd37e"></a>
Eigen::VectorXd&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbmr__model.html#a25229cd8668a635081cef6c04ccfd37e">posterior_probability_vector</a></td></tr>
<tr class="memdesc:a25229cd8668a635081cef6c04ccfd37e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector of posterior expectations for reduced models. <br /></td></tr>
<tr class="separator:a25229cd8668a635081cef6c04ccfd37e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4e7fa28ec0fd5ed42f9f7af139388df"><td class="memItemLeft" align="right" valign="top"><a id="ab4e7fa28ec0fd5ed42f9f7af139388df"></a>
Eigen::MatrixXi&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbmr__model.html#ab4e7fa28ec0fd5ed42f9f7af139388df">model_space</a></td></tr>
<tr class="memdesc:ab4e7fa28ec0fd5ed42f9f7af139388df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Matrix specifying parameters set or not set. <br /></td></tr>
<tr class="separator:ab4e7fa28ec0fd5ed42f9f7af139388df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3572a96a0cbd6539a3b9c786bd28eb2e"><td class="memItemLeft" align="right" valign="top"><a id="a3572a96a0cbd6539a3b9c786bd28eb2e"></a>
dynamic_model_template&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbmr__model.html#a3572a96a0cbd6539a3b9c786bd28eb2e">DCM_out</a></td></tr>
<tr class="memdesc:a3572a96a0cbd6539a3b9c786bd28eb2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output reduced Dynamic Causal Model. <br /></td></tr>
<tr class="separator:a3572a96a0cbd6539a3b9c786bd28eb2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3feb55d112b9a122ee2155f37e5a5175"><td class="memItemLeft" align="right" valign="top"><a id="a3feb55d112b9a122ee2155f37e5a5175"></a>
<a class="el" href="classbma__model.html">bma_model</a>&lt; dynamic_model_template &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>BMA</b></td></tr>
<tr class="separator:a3feb55d112b9a122ee2155f37e5a5175"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;typename dynamic_model_template&gt;<br />
class bmr_model&lt; dynamic_model_template &gt;</h3>

<p>A class for performing Bayesian Model Reduction for the Embecosm DCM package</p>
<p>Copyright (C) 2022 Embecosm Limited</p>
<p>Contributor William Jones <a href="#" onclick="location.href='mai'+'lto:'+'wil'+'li'+'am.'+'jo'+'nes'+'@e'+'mbe'+'co'+'sm.'+'co'+'m'; return false;">willi<span style="display: none;">.nosp@m.</span>am.j<span style="display: none;">.nosp@m.</span>ones@<span style="display: none;">.nosp@m.</span>embe<span style="display: none;">.nosp@m.</span>cosm.<span style="display: none;">.nosp@m.</span>com</a> Contributor Elliot Stein <a href="#" onclick="location.href='mai'+'lto:'+'E.S'+'te'+'in@'+'so'+'ton'+'.a'+'c.u'+'k'; return false;">E.Ste<span style="display: none;">.nosp@m.</span>in@s<span style="display: none;">.nosp@m.</span>oton.<span style="display: none;">.nosp@m.</span>ac.u<span style="display: none;">.nosp@m.</span>k</a></p>
<p>This file is part of the Embecosm Dynamic Causal Modeling package</p>
<p>SPDX-License-Identifier: GPL-3.0-or-later Bayesian Model Reduction Class. Evaluates all sub models of the specified Dynamic Causal Model analytically, without running inversion on each directly. Returns either the model with the highest free energy (Bayesian Model Selection, WIP), or a Bayesian Model Average of all different models. </p>

<p class="definition">Definition at line <a class="el" href="bmr__model_8hh_source.html#l00028">28</a> of file <a class="el" href="bmr__model_8hh_source.html">bmr_model.hh</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="ab636c57d4299fd8e4bbe2c48b3b70a6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab636c57d4299fd8e4bbe2c48b3b70a6c">&#9670;&nbsp;</a></span>reduce()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename dynamic_model_template &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classbmr__model.html">bmr_model</a>&lt; dynamic_model_template &gt;::reduce </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Calculate all reductions of the given DCM.</p>
<p>The returned DCM will vary depending on the parameters of the BMR: a DCm that is the Bayesian Model Average (BMA) of all candidate reduced models, or a DCM that corresponds to the best reduced model (by Free Energy). In the case of a BMA, free energy will be set to -INFINITY</p>
<p>Input Dynamic Causal Model requires at least the following to be defined:</p><ul>
<li>prior_parameter_expectations</li>
<li>prior_parameter_covariances</li>
<li>conditional_parameter_expectations</li>
<li>conditional_parameter_covariances</li>
</ul>
<p>Currently assumptuons and limitations:</p><ul>
<li>BMA only</li>
<li>All parameters selected as valid choices for reduction </li>
</ul>

<p class="definition">Definition at line <a class="el" href="bmr__model_8hh_source.html#l00082">82</a> of file <a class="el" href="bmr__model_8hh_source.html">bmr_model.hh</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>include/<a class="el" href="bmr__model_8hh_source.html">bmr_model.hh</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
